(function(e){function t(t){for(var a,r,i=t[0],s=t[1],u=t[2],l=0,d=[];l<i.length;l++)r=i[l],Object.prototype.hasOwnProperty.call(c,r)&&c[r]&&d.push(c[r][0]),c[r]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);f&&f(t);while(d.length)d.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,r=1;r<n.length;r++){var i=n[r];0!==c[i]&&(a=!1)}a&&(o.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},r={app:0},c={app:0},o=[];function i(e){return s.p+"js/"+({}[e]||e)+"."+{"chunk-10025d17":"179c177a","chunk-2d0e95df":"ee2b22d3","chunk-3494ce80":"6b9e8597","chunk-5e4701c5":"f408ca34","chunk-6c25255b":"32d70e11","chunk-916cf272":"6d8c1855","chunk-9e54a918":"9d712f4f","chunk-5e5abdfe":"a762ccf9","chunk-f3fc7a0e":"8fd2cdc9"}[e]+".js"}function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n={"chunk-10025d17":1,"chunk-3494ce80":1,"chunk-6c25255b":1,"chunk-916cf272":1};r[e]?t.push(r[e]):0!==r[e]&&n[e]&&t.push(r[e]=new Promise((function(t,n){for(var a="css/"+({}[e]||e)+"."+{"chunk-10025d17":"2613ee0c","chunk-2d0e95df":"31d6cfe0","chunk-3494ce80":"cfec736b","chunk-5e4701c5":"31d6cfe0","chunk-6c25255b":"dbb90adc","chunk-916cf272":"be3500e6","chunk-9e54a918":"31d6cfe0","chunk-5e5abdfe":"31d6cfe0","chunk-f3fc7a0e":"31d6cfe0"}[e]+".css",c=s.p+a,o=document.getElementsByTagName("link"),i=0;i<o.length;i++){var u=o[i],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===a||l===c))return t()}var d=document.getElementsByTagName("style");for(i=0;i<d.length;i++){u=d[i],l=u.getAttribute("data-href");if(l===a||l===c)return t()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=t,f.onerror=function(t){var a=t&&t.target&&t.target.src||c,o=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=a,delete r[e],f.parentNode.removeChild(f),n(o)},f.href=c;var m=document.getElementsByTagName("head")[0];m.appendChild(f)})).then((function(){r[e]=0})));var a=c[e];if(0!==a)if(a)t.push(a[2]);else{var o=new Promise((function(t,n){a=c[e]=[t,n]}));t.push(a[2]=o);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.src=i(e);var d=new Error;u=function(t){l.onerror=l.onload=null,clearTimeout(f);var n=c[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+a+": "+r+")",d.name="ChunkLoadError",d.type=a,d.request=r,n[1](d)}c[e]=void 0}};var f=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(t)},s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/student-admin/",s.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=t,u=u.slice();for(var d=0;d<u.length;d++)t(u[d]);var f=l;o.push([0,"chunk-elementUI","chunk-libs"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var a=n("85ec"),r=n.n(a);r.a},"0a5a":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s}));var a=n("a78e"),r=n.n(a),c="token";function o(){return r.a.get(c)}function i(){return r.a.set("token","")}function s(e){return r.a.set("token",e)}},"31dd":function(e,t,n){},4360:function(e,t,n){"use strict";var a=n("2b0e"),r=n("2f62"),c=(n("b0c0"),n("d3b7"),n("0a5a")),o=n("4db3");function i(e){return Object(o["a"])({url:"api/auth/login",method:"post",params:e})}function s(e){return Object(o["a"])({url:"api/user/info",method:"post",params:e})}var u=n("a18c"),l={token:"",name:"",clazz:"",roles:[],avatar:""},d={SET_TOKEN:function(e,t){e.token=t},SET_NAME:function(e,t){e.name=t},SET_ROLES:function(e,t){e.roles=t},SET_CLAZZ:function(e,t){e.clazz=t},SET_AVATAR:function(e,t){e.avatar=t}},f={login:function(e,t){var n=e.commit;return new Promise((function(e,a){i(t).then((function(t){var a=t.data.obj;n("SET_TOKEN",a),Object(c["c"])(a),e()}))["catch"]((function(e){a(e)}))}))},getInfo:function(e,t){var n=e.commit;return new Promise((function(e,a){s({token:t}).then((function(t){var r=t.data;r||a("verification fail");var c=r.name,o=r.roles,i=r.clazzId;(!o||o.length<0)&&a("roles must be a non-null array"),n("SET_NAME",c),n("SET_ROLES",o),n("SET_CLAZZ",i),e(r)}))["catch"]((function(e){a(e)}))}))},logout:function(e){var t=e.commit;Object(c["b"])(),t("SET_TOKEN",""),t("SET_ROLES",[]),t("SET_NAME",""),t("SET_CLAZZ",""),Object(u["d"])()},setAvatar:function(e,t){var n=e.commit;null!==t&&n("SET_AVATAR",t)}},m={namespaced:!0,state:l,mutations:d,actions:f},h=(n("c975"),n("a434"),n("b85c")),p=n("982e"),b={classes:[]},v={SET_CLASSES:function(e,t){e.classes=t},CHANGE_CLASSES:function(e,t){var n,a=Object(h["a"])(e.classes);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(r.id===t.id){var c=e.classes.indexOf(t);e.classes.splice(c,1,t);break}}}catch(o){a.e(o)}finally{a.f()}},DELETE_CLASS:function(e,t){var n,a=Object(h["a"])(e.classes);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(r.id===t.id){var c=e.classes.indexOf(t);e.classes.splice(c,1);break}}}catch(o){a.e(o)}finally{a.f()}}},g={getClasses:function(e){var t=e.commit;return new Promise((function(e,n){Object(p["c"])().then((function(n){t("SET_CLASSES",n.data),e(n.data)}))["catch"]((function(e){throw n(e),new Error(e)}))}))},setClasses:function(e,t){var n=e.commit;n("SET_CLASSES",t)},editClasses:function(e,t){var n=e.commit;n("CHANGE_CLASSES",t)},deleteClasses:function(e,t){var n=e.commit;n("DELETE_CLASS",t)}},E={namespaced:!0,state:b,mutations:v,actions:g},_=(n("99af"),n("4160"),n("caad"),n("45fc"),n("2532"),n("159b"),n("5530"));function S(e,t){return!t.meta||!t.meta.roles||e.some((function(e){return t.meta.roles.includes(e.role_name)}))}function k(e,t){var n=[];return e.forEach((function(e){var a=Object(_["a"])({},e);S(t,a)&&(a.children&&(a.children=k(a.children,t)),n.push(a))})),n}var O={routes:[],addRoutes:[]},w={SET_ROUTES:function(e,t){e.addRoutes=t,e.routes=u["b"].concat(t)}},y={generateRoutes:function(e,t){var n=e.commit;return new Promise((function(e){var a;a=t.includes("ROLE_ADMIN")?u["a"]||[]:k(u["a"],t),n("SET_ROUTES",a),e(a)}))["catch"]((function(e){new Error(e)}))}},j={namespaced:!0,state:O,mutations:w,actions:y},A={isCollapse:!1},C={SET_SIDEBAR:function(e,t){e.isCollapse=t}},T={openSidebar:function(e){var t=e.commit;t("SET_SIDEBAR",!0)},closeSidebar:function(e){var t=e.commit;t("SET_SIDEBAR",!1)}},R={namespaced:!0,state:A,mutations:C,actions:T},L={token:function(e){return e.user.token},name:function(e){return e.user.name},avatar:function(e){return e.user.avatar},roles:function(e){return e.user.roles},clazz:function(e){return e.user.clazz},permittedRoutes:function(e){return e.permission.routes},classes:function(e){return e.grade.classes},sidebar:function(e){return e.sidebar.isCollapse}},x=L;a["default"].use(r["a"]);var P={user:m,permission:j,grade:E,sidebar:R},z=new r["a"].Store({getters:x,modules:P});t["a"]=z},"4db3":function(e,t,n){"use strict";n("d3b7");var a=n("bc3a"),r=n.n(a),c=n("0a5a"),o=n("5c96"),i=r.a.create({baseURL:"https://crazycloth.xyz/",timeout:1e3});i.interceptors.request.use((function(e){var t=Object(c["a"])();return t&&(e.headers["Authorization"]="Bearer "+t),e}),(function(e){return Promise.reject(e)})),i.interceptors.response.use((function(e){return 401===e.status?(Object(o["Message"])({message:"你无权访问！",type:"error"}),Promise.reject(new Error(e.data||"error"))):e})),t["a"]=i},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},c=[],o={name:"App"},i=o,s=(n("034f"),n("2877")),u=Object(s["a"])(i,r,c,!1,null,null,null),l=u.exports,d=n("a18c"),f=n("8c4f"),m=n("5c96"),h=n.n(m),p=n("4360"),b=(n("0fae"),n("ce52"),n("b20f"),n("5530")),v=(n("96cf"),n("1da1")),g=n("0a5a");d["c"].beforeEach(function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(t,n,a){var r,c,o,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(document.title=t.meta.title+" - school admin"||!1,r=Object(g["a"])(),!r){e.next=30;break}if("/login"!==t.path){e.next=7;break}a("/"),e.next=28;break;case 7:if(c=p["a"].getters.roles&&p["a"].getters.roles.length>0,!c){e.next=12;break}a(),e.next=28;break;case 12:return e.prev=12,e.next=15,p["a"].dispatch("user/getInfo",Object(g["a"])());case 15:return o=e.sent,i=o.roles,e.next=19,p["a"].dispatch("permission/generateRoutes",i);case 19:s=e.sent,d["c"].addRoutes(s),p["a"].dispatch("grade/getClasses"),a(Object(b["a"])(Object(b["a"])({},t),{},{replace:!0})),e.next=28;break;case 25:throw e.prev=25,e.t0=e["catch"](12),new Error(e.t0);case 28:e.next=31;break;case 30:"/login"===t.path?a():a("/login");case 31:case"end":return e.stop()}}),e,null,[[12,25]])})));return function(t,n,a){return e.apply(this,arguments)}}());var E=n("ecee"),_=n("c074"),S=n("f2d1"),k=n("ad3d");a["default"].use(h.a),E["c"].add(_["b"],_["d"],_["f"],_["e"],_["g"],_["a"],_["c"]),E["c"].add(S["a"]),a["default"].component("font-awesome-icon",k["a"]),a["default"].config.productionTip=!1,new a["default"]({router:d["c"],store:p["a"],render:function(e){return e(l)}}).$mount("#app");var O=f["a"].prototype.push;f["a"].prototype.push=function(e){return O.call(this,e)["catch"]((function(e){return e}))}},7581:function(e,t,n){"use strict";var a=n("eb22"),r=n.n(a);r.a},"7fd3":function(e,t,n){},"85ec":function(e,t,n){},"982e":function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return s}));var a=n("4db3");function r(){return Object(a["a"])({url:"/api/grade/all",method:"get"})}function c(e,t){return Object(a["a"])({url:"/api/grade/page",params:{page:e,size:t}})}function o(e){return Object(a["a"])({url:"/api/grade/",method:"post",data:e})}function i(e){return Object(a["a"])({url:"/api/grade/",method:"put",data:e})}function s(e){return Object(a["a"])({url:"/api/grade/"+e,method:"delete"})}},a18c:function(e,t,n){"use strict";n.d(t,"b",(function(){return N})),n.d(t,"a",(function(){return I})),n.d(t,"d",(function(){return D}));n("d3b7");var a=n("2b0e"),r=n("8c4f"),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",{staticClass:"main-container"},[n("side-bar"),n("el-container",{staticClass:"main-wrapper",attrs:{direction:"vertical"}},[n("page-header"),n("el-main",{attrs:{direction:"horizontal"}},[n("router-view")],1),n("el-footer",[n("span",[e._v("©"+e._s(e.date)+" ech0o ")]),n("span",[n("a",{attrs:{href:"https://github.com/ech0o"}},[n("font-awesome-icon",{attrs:{icon:["fab","github"],size:"lg"}})],1)])])],1)],1)},o=[],i=(n("0d03"),n("b0c0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sidebar-wrap"},[n("el-menu",{staticClass:"sidebar",attrs:{"default-active":e.activeMenu,router:"","background-color":"#304156","text-color":"hsla(0,0%,100%,.7)","active-text-color":"#409EFF",collapse:e.isCollapse}},e._l(e.permittedRoutes,(function(e){return n("menu-item",{key:e.path,attrs:{item:e}})})),1)],1)}),s=[],u=(n("caad"),n("2532"),n("5530")),l=n("2f62"),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.item.hidden?e._e():n("div",{staticClass:"item-wrapper"},[e.item.children&&(1!==e.item.children.length||e.item.children.hidden||e.item.alwaysShow)?[n("el-submenu",{attrs:{index:e.getPath}},[n("template",{slot:"title"},[e.item.meta.icon?n("font-awesome-icon",{attrs:{icon:e.item.meta.icon,size:"lg","fixed-width":""}}):e._e(),n("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.item.meta.title))])],1),e.item.children&&!e.item.children.hidden?e._l(e.item.children,(function(t){return n("menu-item",{key:t.path,attrs:{item:t,basePath:e.item.path}})})):e._e()],2)]:[n("el-menu-item",{attrs:{index:e.getPath}},[e.item.meta.icon?n("font-awesome-icon",{attrs:{icon:e.item.meta.icon,size:"lg","fixed-width":""}}):e._e(),n("template",{slot:"title"},[e._v(e._s(e.item.meta.title))])],2)]],2)},f=[],m=(n("ac1f"),n("1276"),{name:"menuItem",props:{item:{type:Object,required:!0},basePath:{type:String,default:""}},computed:{getPath:function(){return this.item.redirect?this.item.redirect:this.item.path.includes(":")?this.basePath+"/"+this.item.path.split(":")[0]:this.basePath+"/"+this.item.path}}}),h=m,p=n("2877"),b=Object(p["a"])(h,d,f,!1,null,null,null),v=b.exports,g={name:"SideBar",components:{menuItem:v},computed:Object(u["a"])(Object(u["a"])({},Object(l["b"])(["permittedRoutes","sidebar"])),{},{activeMenu:function(){return this.$route.path.includes("class")?"/manage/class/":this.$route.path},isCollapse:function(){return this.sidebar}})},E=g,_=(n("7581"),Object(p["a"])(E,i,s,!1,null,"056c9842",null)),S=_.exports,k=n("4360"),O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-header",[n("el-button",{staticClass:"sidebar-toggle",attrs:{size:"mini"},on:{click:e.changeCollapse}},[n("font-awesome-icon",{attrs:{icon:["fas","bars"],size:"lg"}},[e._v("test")])],1),n("el-dropdown",{staticClass:"drop",attrs:{trigger:"click","hide-on-click":!0},on:{command:e.handleCommand}},[n("span",{staticClass:"el-dropdown-link"},[n("el-avatar",{attrs:{src:e.avatar}}),n("i",{staticClass:"el-icon-caret-bottom"})],1),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"a"}},[e._v(" 用户中心 ")]),n("el-dropdown-item",{attrs:{command:"b"}},[e._v(" 退出登录 ")])],1)],1)],1)},w=[],y=n("6199"),j=n.n(y),A={name:"pageHeader",data:function(){return{user:k["a"].getters.name,isCollapse:k["a"].getters.sidebar}},computed:{avatar:function(){var e="https://gravatar.com/avatar/"+j()(this.user)+"?d=retro";return this.$store.dispatch("user/setAvatar",e),e}},methods:{logout:function(){this.$store.dispatch("user/logout"),this.$router.push({path:"/login"})},handleCommand:function(e){"b"===e?this.logout():"a"===e&&this.$router.push("/manage/center")},changeCollapse:function(){!0===k["a"].getters.sidebar?this.$store.dispatch("sidebar/closeSidebar"):this.$store.dispatch("sidebar/openSidebar")},setAvatar:function(){if(""===this.avatar){var e="https://gravatar.com/avatar/"+j()(this.user)+"?d=retro";this.$store.dispatch("user/setAvatar",e)}}}},C=A,T=(n("e47d"),Object(p["a"])(C,O,w,!1,null,"a6efa48c",null)),R=T.exports,L={name:"Layout",components:{SideBar:S,pageHeader:R},computed:{date:function(){return(new Date).getFullYear()}},data:function(){return{title:this.$route.path,user:k["a"].getters.name,isCollapse:!1}},methods:{goBack:function(){this.$router.go(-1)}}},x=L,P=(n("cd06"),Object(p["a"])(x,c,o,!1,null,"41d8e959",null)),z=P.exports;a["default"].use(r["a"]);var N=[{path:"/login",name:"Login",hidden:!0,component:function(){return n.e("chunk-3494ce80").then(n.bind(null,"a55b"))},meta:{title:"login"}},{path:"/",name:"index",redirect:"/dashboard",component:z,meta:{title:"主页",icon:["fas","home"]},children:[{path:"dashboard",name:"userIndex",component:function(){return n.e("chunk-6c25255b").then(n.bind(null,"1e4b"))},hidden:!0,meta:{title:"dashboard"}}]}],I=[{path:"/manage",name:"manage",component:z,alwaysShow:!0,redirect:"/student",meta:{roles:["ROLE_ADMIN","ROLE_USER"],title:"管理",icon:["fas","tools"]},children:[{path:"class/:clazz?",name:"student",component:function(){return n.e("chunk-f3fc7a0e").then(n.bind(null,"19b7"))},meta:{roles:["ROLE_ADMIN","ROLE_USER"],title:"学生管理",icon:["fas","user-graduate"]}},{path:"user",name:"user",component:function(){return n.e("chunk-10025d17").then(n.bind(null,"4a2b"))},meta:{title:"用户管理",roles:["ROLE_ADMIN"],icon:["fas","user"]}},{path:"role",name:"role",component:function(){return Promise.all([n.e("chunk-9e54a918"),n.e("chunk-5e5abdfe")]).then(n.bind(null,"d5c7"))},meta:{title:"角色管理",roles:["ROLE_ADMIN"],icon:["fas","tasks"]}},{path:"grade",name:"class",component:function(){return n.e("chunk-5e4701c5").then(n.bind(null,"7ffc"))},meta:{title:"班级管理",roles:["ROLE_ADMIN"],icon:["fas","users"]}},{path:"center",name:"用户中心",hidden:!0,component:function(){return n.e("chunk-916cf272").then(n.bind(null,"6494"))},meta:{title:"user center",roles:["ROLE_ADMIN","ROLE_USER"]}}]},{path:"*",name:"404",hidden:!0,component:function(){return n.e("chunk-2d0e95df").then(n.bind(null,"8cdb"))},meta:{title:"404",roles:["ROLE_ADMIN","ROLE_USER"]}}],M=function(){return new r["a"]({routes:N})},$=M();function D(){var e=M();$.matcher=e.matcher}t["c"]=$},b20f:function(e,t,n){},cd06:function(e,t,n){"use strict";var a=n("7fd3"),r=n.n(a);r.a},ce52:function(e,t,n){},e47d:function(e,t,n){"use strict";var a=n("31dd"),r=n.n(a);r.a},eb22:function(e,t,n){}});
//# sourceMappingURL=app.5148df39.js.map