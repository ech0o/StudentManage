{"version":3,"sources":["webpack:///./src/components/normalTable.vue?c6f2","webpack:///src/components/normalTable.vue","webpack:///./src/components/normalTable.vue?27ec","webpack:///./src/components/normalTable.vue","webpack:///./src/views/RoleManage.vue?edce","webpack:///./src/api/roleList.js","webpack:///src/views/RoleManage.vue","webpack:///./src/views/RoleManage.vue?1321","webpack:///./src/views/RoleManage.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","tableData","_e","_l","col","key","id","ref","refInFor","label","scopedSlots","_u","fn","scope","_t","_v","_s","row","width","on","$event","editItem","deleteItem","staticRenderFns","name","props","Array","columns","flag","String","changed","Object","created","index","Boolean","deleteFlag","watch","stu","student","unshift","methods","addNew","item","$emit","$confirm","comfirmButtonText","cancelButtonText","type","i","component","_m","staticStyle","handleCreate","roleList","handleEdit","deleteRole","titleMap","dialogStatus","dialogVisible","role","checkRules","model","value","callback","$$v","$set","expression","checkStrictly","routes","defaultProps","slot","handleAddRole","handleUpdate","getAllRoleList","service","url","getAllRoutes","undefined","roleName","comment","components","normalTable","data","routesData","children","edit","create","rules_edit","rules_create","createRole","editRole","getData","computed","generateRoutes","then","res","generateArr","forEach","route","length","push","generateTree","assign","defaultRole","$refs","tree","setCheckedNodes","$nextTick","validate","valid","message","ConfirmButtonText","CancelButtonText","updateRoutes","matched","clearRole","isArray","meta","roles","splice"],"mappings":"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","file":"js/chunk-5e5abdfe.6dedc1ce.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"wrapper\"},[_c('el-table',{attrs:{\"data\":_vm.tableData,\"stripe\":\"\"}},[(_vm.index)?_c('el-table-column',{attrs:{\"type\":\"index\"}}):_vm._e(),_vm._l((_vm.columns),function(col){return _c('el-table-column',{key:col.id,ref:col.id,refInFor:true,attrs:{\"prop\":col.id,\"label\":col.label},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._t(col.id,[_vm._v(_vm._s(scope.row[col.id]))],{\"scope\":scope})]}}],null,true)})}),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":_vm.width},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._t(\"btnArea\",[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.editItem(scope.row)}}},[_vm._v(\"编辑\")]),_c('el-button',{attrs:{\"type\":\"danger\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.deleteItem(scope.row.id)}}},[_vm._v(\"删除\")])],{\"scope\":scope})]}}],null,true)})],2)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"wrapper\">\n    <el-table :data=\"tableData\" stripe>\n      <el-table-column v-if=\"index\" type=\"index\"></el-table-column>\n      <el-table-column\n        v-for=\"col in columns\"\n        :ref=\"col.id\"\n        :prop=\"col.id\"\n        :key=\"col.id\"\n        :label=\"col.label\"\n      >\n        <template slot-scope=\"scope\">\n          <slot :name=\"col.id\" :scope=\"scope\">{{scope.row[col.id]}}</slot>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"操作\"  :width=\"width\">\n        <template slot-scope=\"scope\">\n          <slot name=\"btnArea\" :scope=\"scope\">\n            <el-button type=\"primary\" size=\"small\" @click=\"editItem(scope.row)\">编辑</el-button>\n            <el-button type=\"danger\" size=\"small\" @click=\"deleteItem(scope.row.id)\">删除</el-button>\n          </slot>\n        </template>\n      </el-table-column>\n    </el-table>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"normalTable\",\n  props: {\n    tableData: Array,\n    columns: Array,\n    flag: String,\n    changed: Object,\n    created: Object,\n    index: Boolean,\n    deleteFlag: Boolean,\n    width:Number\n  },\n  watch: {\n    changed: function(stu) {\n      if (stu !== null) {\n        for (let i of this.tableData) {\n          if (i.id === stu.id) {\n            const index = this.tableData.indexOf(i);\n            this.tableData.splice(index, 1, stu);\n            break;\n          }\n        }\n      }\n    },\n    created: function(student) {\n      if (student !== null) {\n        this.tableData.unshift(student);\n      }\n    }\n  },\n  methods: {\n    addNew(item) {\n      if (this.flag === \"add\") {\n        this.tableData.unshift(item);\n      }\n    },\n    editItem(row) {\n      this.$emit(\"handleEdit\", row);\n    },\n    deleteItem(id) {\n      this.$confirm(\"是否删除\", \"提示\", {\n        comfirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      })\n        .then(() => {\n          this.$emit(\"handleDelete\", id);\n          if (this.deleteFlag == true) {\n            for (let i of this.tableData) {\n              if (i.id == id) {\n                const index = this.tableData.indexOf(i);\n                this.tableData.splice(index, 1);\n                break;\n              }\n            }\n          }\n        })\n        .catch(() => {\n          return;\n        });\n    }\n  }\n};\n</script>\n\n<style>\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./normalTable.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./normalTable.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./normalTable.vue?vue&type=template&id=29cfecb6&\"\nimport script from \"./normalTable.vue?vue&type=script&lang=js&\"\nexport * from \"./normalTable.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"main\"},[_c('div',{staticClass:\"wrapper\"},[_vm._m(0),_c('el-card',[_c('el-button',{staticStyle:{\"float\":\"right\"},on:{\"click\":_vm.handleCreate}},[_c('i',{staticClass:\"el-icon-plus\"}),_vm._v(\"添加 \")]),_c('normal-table',{attrs:{\"tableData\":_vm.roleList,\"columns\":_vm.columns,\"width\":200,\"index\":true},scopedSlots:_vm._u([{key:\"btnArea\",fn:function(ref){\nvar scope = ref.scope;\nreturn [_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"},on:{\"click\":function($event){return _vm.handleEdit(scope)}}},[_vm._v(\"编辑\")]),_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"danger\"},on:{\"click\":function($event){return _vm.deleteRole(scope)}}},[_vm._v(\"删除\")])]}}])})],1),_c('el-dialog',{attrs:{\"title\":_vm.titleMap[_vm.dialogStatus],\"visible\":_vm.dialogVisible,\"center\":\"\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-form',{ref:\"role\",attrs:{\"model\":_vm.role,\"label-width\":\"80px\",\"rules\":_vm.checkRules()}},[_c('el-form-item',{attrs:{\"label\":\"name\",\"prop\":\"roleName\"}},[_c('el-input',{model:{value:(_vm.role.roleName),callback:function ($$v) {_vm.$set(_vm.role, \"roleName\", $$v)},expression:\"role.roleName\"}})],1),_c('el-form-item',{attrs:{\"label\":\"commet\",\"prop\":\"comment\"}},[_c('el-input',{model:{value:(_vm.role.comment),callback:function ($$v) {_vm.$set(_vm.role, \"comment\", $$v)},expression:\"role.comment\"}})],1),_c('el-form-item',{attrs:{\"label\":\"menu\"}},[_c('el-tree',{ref:\"tree\",attrs:{\"check-strictly\":_vm.checkStrictly,\"data\":_vm.routes,\"props\":_vm.defaultProps,\"node-key\":\"path\",\"show-checkbox\":\"\"}})],1)],1),_c('span',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogVisible= false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.dialogStatus=='create'?_vm.handleAddRole(): _vm.handleUpdate()}}},[_vm._v(\"确 定\")])],1)],1)],1)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"title\"},[_c('h2',[_vm._v(\"角色管理\")])])}]\n\nexport { render, staticRenderFns }","import service from '@/plugin/axios/service'\n\nexport function getAllRoleList() {\n  return service({\n    url: '/api/roles/all'\n  })\n}\n\nexport function getAllRoutes() {\n  return service({\n    url:'/api/route/all'\n  })\n}","<template>\n  <div class=\"main\">\n    <div class=\"wrapper\">\n      <div class=\"title\">\n        <h2>角色管理</h2>\n      </div>\n      <el-card>\n      <el-button style=\"float:right\" @click=\"handleCreate\">\n        <i class=\"el-icon-plus\"></i>添加\n      </el-button>\n      <normal-table \n      :tableData=\"roleList\"\n      :columns=\"columns\"\n      :width=\"200\"\n      :index=\"true\"\n      >\n      <template #btnArea={scope}>\n        <el-button size=\"small\" type=\"primary\" @click=\"handleEdit(scope)\">编辑</el-button>\n        <el-button size=\"small\" type=\"danger\" @click=\"deleteRole(scope)\">删除</el-button>\n      </template>       \n      </normal-table>\n      </el-card>\n      <el-dialog :title=\"titleMap[dialogStatus]\" :visible.sync=\"dialogVisible\" center>\n        <el-form :model=\"role\" label-width=\"80px\" :rules=\"checkRules()\" ref=\"role\">\n          <el-form-item label=\"name\" prop=\"roleName\">\n            <el-input v-model=\"role.roleName\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"commet\" prop=\"comment\">\n            <el-input v-model=\"role.comment\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"menu\">\n            <el-tree\n              ref=\"tree\"\n              :check-strictly=\"checkStrictly\"\n              :data=\"routes\"\n              :props=\"defaultProps\"\n              node-key=\"path\"\n              show-checkbox\n            ></el-tree>\n          </el-form-item>\n        </el-form>\n\n        <span slot=\"footer\">\n          <el-button @click=\" dialogVisible= false\">取 消</el-button>\n          <el-button\n            type=\"primary\"\n            @click=\"dialogStatus=='create'?handleAddRole(): handleUpdate()\"\n          >确 定</el-button>\n        </span>\n      </el-dialog>\n    </div>\n  </div>\n</template>\n<script>\nimport path from \"path\";\nimport _ from \"lodash\";\nimport { getAllRoleList, getAllRoutes } from \"@/api/roleList\";\nimport normalTable from '../components/normalTable'\nconst defaultRole = {\n  id: undefined,\n  roleName: \"\",\n  comment: \"\",\n  routes: []\n};\nexport default {\n  name:'roleManage',\n  components:{\n    normalTable\n  },\n\n  data() {\n    return {\n      routesData: [],\n\n      roleList: [],\n      defaultProps: {\n        children: \"children\",\n        label: \"name\"\n      },\n      titleMap: {\n        edit: \"edit\",\n        create: \"create\"\n      },\n      dialogStatus: \"\",\n      checkStrictly: false,\n      dialogVisible: false,\n      role: {\n        id: \"\",\n        roleName: \"\",\n        comment: \"\",\n        routes: []\n      },\n      rules_edit: {\n        roleName: [{ required: true, message: \"请输入姓名\", trigger: \"change\" }]\n      },\n      rules_create: {\n        roleName: [{ required: true, message: \"请输入姓名\", trigger: \"blur\" }]\n      },\n\n      // for table\n      columns:[\n        {\n          id:'roleName',\n          label:'名称'\n        },\n        {\n          id:'comment',\n          label:'备注'\n        }\n      ],\n      createRole:undefined,\n      editRole:undefined,\n      deleteFlag:false,\n    };\n  },\n  created() {\n    this.getData();\n  },\n  computed: {\n    routes() {\n      return this.generateRoutes(this.routesData);\n    }\n  },\n  methods: {\n    getData() {\n      getAllRoutes().then(resp => {\n        this.routesData = resp.data;\n      });\n\n      getAllRoleList().then(resp => {\n        this.roleList = resp.data;\n      });\n    },\n\n    checkRules() {\n      if (this.dialogStatus === \"edit\") {\n        return this.rules_edit;\n      } else {\n        return this.rules_create;\n      }\n    },\n\n    generateRoutes(routes, basePath = \"/\") {\n      let res = [];\n      for (let route of routes) {\n        if (route.hidden) {\n          continue;\n        }\n        if (\n          !route.children ||\n          (route.children.length == 1 && route.children.hidden)\n        ) {\n          let data = {\n            name: route.meta && route.meta.title,\n            path: path.resolve(basePath, route.path),\n            children: null\n          };\n          res.push(data);\n        } else {\n          let data = {\n            name: route.meta && route.meta.title,\n            path: path.resolve(basePath, route.path),\n            children: null\n          };\n          if (route.children) {\n            data.children = this.generateRoutes(route.children, data.path);\n          }\n          res.push(data);\n        }\n      }\n      return res;\n    },\n\n    generateArr(routes) {\n      let res = [];\n      routes.forEach(route => {\n        if (route.children && route.children.length > 0) {\n          const tmp = this.generateArr(route.children);\n          res = [...res, ...tmp];\n        } else {\n          res.push(route);\n        }\n      });\n      return res;\n    },\n\n    generateTree(routes, basePath = \"/\", checkedKeys) {\n      const res = [];\n\n      for (const route of routes) {\n        const routePath = path.resolve(basePath, route.path);\n        // recursive child routes\n        if (route.children) {\n          route.children = this.generateTree(\n            route.children,\n            routePath,\n            checkedKeys\n          );\n        }\n\n        if (\n          checkedKeys.includes(routePath) ||\n          (route.children && route.children.length >= 1)\n        ) {\n          res.push(route);\n        }\n      }\n      return res;\n    },\n\n    handleCreate() {\n      this.role = Object.assign({}, defaultRole);\n      if (this.$refs.tree) {\n        this.$refs.tree.setCheckedNodes([]);\n      }\n      this.dialogStatus = \"create\";\n      this.dialogVisible = true;\n      this.$nextTick(() => {\n        this.$refs[\"role\"].clearValidate();\n      });\n    },\n\n    handleEdit(scope) {\n      this.dialogVisible = true;\n      this.dialogStatus = \"edit\";\n      this.role = _.cloneDeep(scope.row);\n      this.$nextTick(() => {\n        const routes = this.generateRoutes(this.role.routes);\n        this.$refs.tree.setCheckedNodes(this.generateArr(routes));\n        this.checkStrictly = false;\n        this.$refs[\"role\"].clearValidate();\n      });\n    },\n\n    handleUpdate() {\n      this.$refs[\"role\"].validate(valid => {\n        if (valid) {\n          const checkedKeys = this.$refs.tree.getCheckedKeys();\n          this.role.routes = this.generateTree(\n            _.cloneDeep(this.routesData),\n            \"/\",\n            checkedKeys\n          );\n\n          for (let index = 0; index < this.roleList.length; index++) {\n            if (this.roleList[index].id === this.role.id) {\n              this.roleList.splice(index, 1, Object.assign({}, this.role));\n              break;\n            }\n          }\n          this.dialogVisible = false;\n          this.$message({\n            type:'success',\n            message:'修改成功'\n          })\n        } else {\n          this.$message.error('修改失败')\n          return false;\n        }\n      });\n    },\n\n    handleAddRole() {\n      this.$refs[\"role\"].validate(valid => {\n        if (valid) {\n          const checkedKeys = this.$refs.tree.getCheckedKeys();\n          this.role.routes = this.generateTree(\n            _.cloneDeep(this.routesData),\n            \"/\",\n            checkedKeys\n          );\n          this.roleList.push(this.role);\n          this.dialogVisible = false;\n          this.$message({\n            type:'success',\n            message:'添加成功'\n          })\n        }else{\n          this.$message.error('添加失败')\n          return false;\n        }\n      });\n    },\n\n    deleteRole(scope) {\n      this.$confirm(\"是否删除\", \"提示\", {\n        ConfirmButtonText: \"确定\",\n        CancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(() => {\n        for (let index = 0; index < this.roleList.length; index++) {\n          if (this.roleList[index].role_name == scope.row.role_name) {\n            this.roleList.splice(index, 1);\n            break;\n          }\n        }\n        this.$message({\n          type: \"success\",\n          message: \"已删除\"\n        });\n      }).catch(()=>{\n        return;\n      });\n    },\n\n    updateRoutes(routes, roleRoutes, roleName) {\n      routes.forEach(route => {\n        route.matched = false;\n        for (let i of roleRoutes) {\n          if (\n            route.path === i.path ||\n            route.path == \"*\" ||\n            route.path == \"dashboard\"\n          ) {\n            route.matched = true;\n            if (!route.meta.roles.some(role => role === roleName)) {\n              route.meta.roles.push(roleName);\n            }\n            if (route.children && i.children) {\n              this.updateRoutes(route.children, i.children, roleName);\n            }\n            break;\n          }\n        }\n        if (!route.matched) {\n          this.clearRole(route, roleName);\n        }\n      });\n    },\n\n    clearRole(routes, roleName) {\n      //console.log(routes);\n      if (Array.isArray(routes)) {\n        for (let route of routes) {\n          for (let index = 0; index < route.meta.roles.length; index++) {\n            if (route.meta.roles[index] === roleName) {\n              route.meta.roles.splice(index, 1);\n            }\n          }\n          route.matched = false;\n          if (route.children) {\n            this.clearRole(route.children, roleName);\n          }\n        }\n      } else {\n        for (let index = 0; index < routes.meta.roles.length; index++) {\n          if (routes.meta.roles[index] === roleName) {\n            routes.meta.roles.splice(index, 1);\n          }\n        }\n        if (routes.children) {\n          this.clearRole(routes.children, roleName);\n        }\n      }\n    }\n  }\n};\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RoleManage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RoleManage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./RoleManage.vue?vue&type=template&id=d8e70410&\"\nimport script from \"./RoleManage.vue?vue&type=script&lang=js&\"\nexport * from \"./RoleManage.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}